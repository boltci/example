name: Laravel

on:
  push:
  workflow_dispatch:

jobs:
  composite-action-test:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        chunk: [1, 2, 3]
    env:
      IMAGE_VERSION: 'd37c8bb6-a2ac-429e-a5c8-8b5180e1a98d'
      CHUNKS: 3
      MAX_PROCESSES: 2
    steps:
      - uses: actions/checkout@v4

      - name: Call BoltCI's Action
        uses: boltci/action@test-secrets-v3
        with:
          index: ${{ matrix.chunk }}
          chunks: ${{ env.CHUNKS }}
          max-processes: ${{ env.MAX_PROCESSES }}
          image: ghcr.io/boltci/boltci:${{ env.IMAGE_VERSION }}
          secrets: |
            {"foo": "${{ secrets.FOO }}"}
